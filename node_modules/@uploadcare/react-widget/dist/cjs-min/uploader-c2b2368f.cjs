"use strict";var e=require("./index-8c2a3b3d.cjs"),n=require("react"),r=require("uploadcare-widget"),t=require("./default-preview-url-callback-60ccb260.cjs"),a=require("react-fast-compare");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("@uploadcare/client-suspense");var l=u(n),o=u(r),c=u(a);var i=["id","name","value","onFileSelect","onChange","onDialogOpen","onDialogClose","onTabChange","apiRef","customTabs","validators","tabsCss","locale","localeTranslations","localePluralize","previewUrlCallback","metadataCallback"],s=function(r,a){var u=r.id,o=r.name,s=r.value,f=r.onFileSelect,d=r.onChange,C=r.onDialogOpen,p=r.onDialogClose,m=r.onTabChange,v=r.apiRef,b=r.customTabs,E=r.validators,g=r.tabsCss,A=r.locale,L=r.localeTranslations,O=r.localePluralize,w=r.previewUrlCallback,k=r.metadataCallback,D=e._objectWithoutProperties(r,i),R=n.useRef(null),h=n.useRef(null),U=n.useRef(null),P=t.useCommitedCallback(f),_=t.useCommitedCallback(d),T=t.useCommitedCallback(C),S=t.useCommitedCallback(p),j=t.useCommitedCallback(m),I=t.useCommitedCallback(k),q=t.useCommitedCallback(w||t.defaultPreviewUrlCallback),y=function(e,r){var t=!0,a=n.useRef();a.current?t=!!(r&&a.current.deps&&c.default(r,a.current.deps)):a.current={deps:r,result:e()};var u=t?a.current:{deps:r,result:e()};return a.current=u,u.result}((function(){return D}),[D]);return t.useCustomTabs(b,a),t.useDeepEffect((function(){return A&&(window.UPLOADCARE_LOCALE=A),O&&(window.UPLOADCARE_LOCALE_PLURALIZE=O),L&&(window.UPLOADCARE_LOCALE_TRANSLATIONS=L),a.plugin((function(e){e.locale.rebuild({locale:A||null,localeTranslations:L||null,localePluralize:O||null})})),function(){A&&delete window.UPLOADCARE_LOCALE,O&&delete window.UPLOADCARE_LOCALE_PLURALIZE,L&&delete window.UPLOADCARE_LOCALE_TRANSLATIONS}}),[A,L,O]),n.useEffect((function(){var n=R.current;h.current=a.Widget(n,e._objectSpread2(e._objectSpread2({},y),{},{metadataCallback:y.metadata?void 0:I,previewUrlCallback:q}));var r=n.nextSibling;return U.current&&h.current.value(U.current),function(){a.jQuery(n).removeData("uploadcareWidget"),r&&r.remove()}}),[a,y,I,q]),function(e,r){n.useEffect((function(){if(null!=r){var n=e.current;return r.forEach((function(e){n.validators.push(e)})),function(){n.validators.length=0}}}),[e,r])}(h,E),n.useEffect((function(){return h.current.onUploadComplete.add(_),h.current.onChange.add(P),function(){h.current.onUploadComplete.remove(_),h.current.onChange.remove(P)}}),[_,P,a,y]),n.useEffect((function(){var e,n=function(n){(e=n).done(S).fail(S).progress(j),T(n)};return h.current.onDialogOpen.add(n),function(){h.current.onDialogOpen.remove(n),e&&e.reject()}}),[S,T,j,y]),n.useEffect((function(){var e=[],n=function(n){e=n?n.files?n.files():[n]:[]};return h.current.onChange.add(n),function(){e.forEach((function(e){return e.cancel()})),h.current.onChange.remove(n)}}),[y]),n.useEffect((function(){U.current!==s&&h.current.value(s),U.current=s}),[s]),n.useEffect((function(){a&&g&&"string"==typeof g&&(0===g.indexOf("https://")?a.tabsCss.addUrl(g):a.tabsCss.addStyle(g))}),[a,g]),n.useImperativeHandle(v,(function(){return{openDialog:function(){return h.current.openDialog()},reloadInfo:function(){return h.current.reloadInfo()},getInput:function(){return h.current.inputElement},value:function(e){return h.current.value(e)}}}),[]),n.useCallback((function(){return l.default.createElement("input",{type:"hidden",ref:R,id:u,name:o})}),[u,o])};exports.default=function(e){var n=s(e,o.default);return l.default.createElement(n,null)};
