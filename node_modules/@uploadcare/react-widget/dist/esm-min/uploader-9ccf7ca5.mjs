import{_ as e,a as n}from"./index-af0ad5a4.mjs";import r,{useEffect as a,useRef as t,useCallback as o,useImperativeHandle as l}from"react";import u from"uploadcare-widget";import{u as c,a as i,b as d,d as f}from"./default-preview-url-callback-99f7fcfa.mjs";import s from"react-fast-compare";import"@uploadcare/client-suspense";var p=["id","name","value","onFileSelect","onChange","onDialogOpen","onDialogClose","onTabChange","apiRef","customTabs","validators","tabsCss","locale","localeTranslations","localePluralize","previewUrlCallback","metadataCallback"],m=function(u,m){var C=u.id,v=u.name,g=u.value,A=u.onFileSelect,L=u.onChange,E=u.onDialogOpen,O=u.onDialogClose,b=u.onTabChange,w=u.apiRef,D=u.customTabs,h=u.validators,U=u.tabsCss,R=u.locale,P=u.localeTranslations,T=u.localePluralize,_=u.previewUrlCallback,S=u.metadataCallback,k=e(u,p),I=t(null),j=t(null),x=t(null),y=c(A),N=c(L),z=c(E),F=c(O),W=c(b),Z=c(S),Q=c(_||f),q=function(e,n){var r=!0,a=t();a.current?r=!!(n&&a.current.deps&&s(n,a.current.deps)):a.current={deps:n,result:e()};var o=r?a.current:{deps:n,result:e()};return a.current=o,o.result}((function(){return k}),[k]);return i(D,m),d((function(){return R&&(window.UPLOADCARE_LOCALE=R),T&&(window.UPLOADCARE_LOCALE_PLURALIZE=T),P&&(window.UPLOADCARE_LOCALE_TRANSLATIONS=P),m.plugin((function(e){e.locale.rebuild({locale:R||null,localeTranslations:P||null,localePluralize:T||null})})),function(){R&&delete window.UPLOADCARE_LOCALE,T&&delete window.UPLOADCARE_LOCALE_PLURALIZE,P&&delete window.UPLOADCARE_LOCALE_TRANSLATIONS}}),[R,P,T]),a((function(){var e=I.current;j.current=m.Widget(e,n(n({},q),{},{metadataCallback:q.metadata?void 0:Z,previewUrlCallback:Q}));var r=e.nextSibling;return x.current&&j.current.value(x.current),function(){m.jQuery(e).removeData("uploadcareWidget"),r&&r.remove()}}),[m,q,Z,Q]),function(e,n){a((function(){if(null!=n){var r=e.current;return n.forEach((function(e){r.validators.push(e)})),function(){r.validators.length=0}}}),[e,n])}(j,h),a((function(){return j.current.onUploadComplete.add(N),j.current.onChange.add(y),function(){j.current.onUploadComplete.remove(N),j.current.onChange.remove(y)}}),[N,y,m,q]),a((function(){var e,n=function(n){(e=n).done(F).fail(F).progress(W),z(n)};return j.current.onDialogOpen.add(n),function(){j.current.onDialogOpen.remove(n),e&&e.reject()}}),[F,z,W,q]),a((function(){var e=[],n=function(n){e=n?n.files?n.files():[n]:[]};return j.current.onChange.add(n),function(){e.forEach((function(e){return e.cancel()})),j.current.onChange.remove(n)}}),[q]),a((function(){x.current!==g&&j.current.value(g),x.current=g}),[g]),a((function(){m&&U&&"string"==typeof U&&(0===U.indexOf("https://")?m.tabsCss.addUrl(U):m.tabsCss.addStyle(U))}),[m,U]),l(w,(function(){return{openDialog:function(){return j.current.openDialog()},reloadInfo:function(){return j.current.reloadInfo()},getInput:function(){return j.current.inputElement},value:function(e){return j.current.value(e)}}}),[]),o((function(){return r.createElement("input",{type:"hidden",ref:I,id:C,name:v})}),[C,v])},C=function(e){var n=m(e,u);return r.createElement(n,null)};export{C as default};
